/* Reset and base styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --bg-grad-a: #667eea;
    --bg-grad-b: #764ba2;
    --text: #2d3748;
    --muted: #4a5568;
    --panel: #ffffff;
    --panel-2: #f8fafc;
    --brand: #6366f1;
    --brand-2: #8b5cf6;
    --accent: #22d3ee;
    --border: #e2e8f0;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
    color: var(--text);
    background: linear-gradient(135deg, var(--bg-grad-a) 0%, var(--bg-grad-b) 50%, var(--bg-grad-a) 100%);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    min-height: 100vh;
    display: flex;
        padding: 0.5rem 1rem;
        background: rgba(255, 255, 255, 0.2);
    position: relative;
}

/* Wallpaper overlay (70% transparent) */
body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url('https://raw.githubusercontent.com/DavidLin-Hub/My-Website/refs/heads/main/some_image/A-G-WALLPAPER.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    opacity: 0.7;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    /* Clean stylesheet: transparent everywhere except cards (sidebar items + article) */
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--bg-grad-a:#667eea;--bg-grad-b:#764ba2;--text:#2d3748;--muted:#4a5568;--brand:#6366f1;--brand-2:#8b5cf6;--accent:#22d3ee;--border:#e2e8f0}
    body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;line-height:1.6;color:var(--text);background:linear-gradient(135deg,var(--bg-grad-a) 0%,var(--bg-grad-b) 50%,var(--bg-grad-a) 100%);background-size:400% 400%;animation:gradientShift 15s ease infinite;min-height:100vh;display:flex;flex-direction:column;position:relative}
    body::after{content:'';position:fixed;inset:0;background-image:url('https://raw.githubusercontent.com/DavidLin-Hub/My-Website/refs/heads/main/some_image/A-G-WALLPAPER.jpg');background-size:cover;background-position:center;background-repeat:no-repeat;opacity:.7;pointer-events:none;z-index:0}
    @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    /* Header is opaque for readability */
    .header{background:#ffffff;color:var(--text);padding:2rem 0;text-align:center;position:relative;box-shadow:0 6px 20px rgba(0,0,0,.08);border-bottom-left-radius:16px;border-bottom-right-radius:16px}
    .header::before{display:none}
    .header-content{position:relative;z-index:1}
    #reading-progress{position:absolute;left:0;right:0;bottom:0;height:4px;background:linear-gradient(90deg,#22d3ee,#a78bfa);width:0%;box-shadow:0 0 12px rgba(34,211,238,.6)}
    .logo{display:flex;align-items:center;justify-content:center;gap:.5rem;margin-bottom:.25rem}
    .header h1{font-size:3rem;font-weight:700;margin:0;text-shadow:none;background:linear-gradient(45deg,#111827,#334155);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .subtitle{font-size:1.2rem;opacity:.9;font-weight:300;margin-bottom:1.5rem;color:#4a5568}
    .language-switcher{display:flex;gap:.5rem;justify-content:center;flex-wrap:wrap}
    .lang-btn{padding:.5rem 1rem;background:#f8fafc;border:1px solid #e2e8f0;color:#334155;border-radius:25px;cursor:pointer;font-size:.9rem;font-weight:500;transition:all .2s ease}
    .lang-btn:hover{background:#eef2ff;border-color:#c7d2fe;transform:translateY(-1px)}
    .lang-btn.active{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;border-color:transparent;transform:translateY(-1px) scale(1.03);box-shadow:0 6px 16px rgba(99,102,241,.3)}
    .theme-toggle{padding:.5rem .8rem;background:#f8fafc;border:1px solid #e2e8f0;color:#334155;border-radius:10px;cursor:pointer;transition:all .2s ease}
    .theme-toggle:hover{background:#eef2ff;border-color:#c7d2fe;transform:translateY(-1px)}
    .container{max-width:1400px;margin:0 auto;background:transparent;position:relative;z-index:1}
    .main-content{display:grid;grid-template-columns:350px 1fr;flex:1;min-height:0}
    .sidebar{background:transparent;padding:2rem 0;overflow-y:auto;max-height:calc(100vh - 200px);position:relative}
    .sidebar::before{display:none}
    .sidebar-header{padding:0 1.5rem 1rem;margin-bottom:1.5rem;position:relative;z-index:1}
    .search-wrap{margin-top:.8rem;position:sticky;top:.5rem}
    #nav-search{width:100%;padding:.6rem .9rem;border-radius:10px;border:1px solid #e2e8f0;background:#fff;outline:none;font-size:.9rem;transition:box-shadow .2s ease,border-color .2s ease}
    #nav-search:focus{border-color:#6366f1;box-shadow:0 0 0 4px rgba(99,102,241,.15)}
    .sidebar-header h2{color:#4a5568;font-size:1.1rem;font-weight:600;background:linear-gradient(135deg,#4a5568,#6366f1);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .chapter-nav{padding:0 1rem;position:relative;z-index:1}
    .chapter-section{margin-bottom:2rem;background:#fff;border-radius:12px;padding:1rem;box-shadow:0 6px 18px rgba(0,0,0,.06);transition:all .3s ease}
    .chapter-section:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .chapter-section.collapsible>h3{cursor:pointer;display:flex;align-items:center;gap:.4rem}
    .chapter-section.collapsible>h3::after{content:'\25BE';font-size:.9em;color:#6366f1;transition:transform .2s ease}
    .chapter-section.collapsible.collapsed>h3::after{transform:rotate(-90deg)}
    .chapter-section.collapsible.collapsed ul{display:none}
    .chapter-section h3{color:#2d3748;font-size:.9rem;font-weight:600;margin-bottom:.8rem;padding:0 .5rem;text-transform:uppercase;letter-spacing:.5px;background:linear-gradient(135deg,#6366f1,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .chapter-section ul{list-style:none}
    .chapter-section li{margin-bottom:.3rem}
    .chapter-section a{display:block;color:#4a5568;text-decoration:none;padding:.6rem .8rem;border-radius:8px;font-size:.9rem;transition:all .3s ease;border-left:3px solid transparent;position:relative;overflow:hidden}
    .chapter-section a::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(99,102,241,.1),transparent);transition:left .5s ease}
    .chapter-section a:hover::before{left:100%}
    .chapter-section a:hover{background:linear-gradient(135deg,#e2e8f0,#f1f5f9);color:#2d3748;border-left-color:#6366f1;transform:translateX(5px);box-shadow:0 2px 10px rgba(99,102,241,.2)}
    .chapter-section a.active{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;border-left-color:#4f46e5;font-weight:500;box-shadow:0 4px 15px rgba(99,102,241,.4)}
    .content{padding:2rem 2.5rem;background:transparent;overflow-y:auto;max-height:calc(100vh - 200px)}
    .article-content{background:#fff;border-radius:16px;border:1px solid #eef2ff;box-shadow:0 8px 30px rgba(99,102,241,.08);padding:2rem;opacity:0;transform:translateY(8px);transition:opacity .3s ease,transform .3s ease;max-width:1100px;margin:0 auto}
    .article-content.show{opacity:1;transform:translateY(0)}
    /* reveal animation helpers */
    .reveal-init{opacity:0;transform:translateY(10px)}
    .reveal-in{opacity:1;transform:translateY(0);transition:opacity .45s ease,transform .45s cubic-bezier(.2,.6,.2,1)}
    .article-content h1{color:#1a202c;font-size:2.5rem;font-weight:700;margin-bottom:1.5rem;border-bottom:3px solid #6366f1;padding-bottom:.5rem}
    .article-content h2{color:#2d3748;font-size:1.8rem;font-weight:600;margin:2rem 0 1rem;border-left:4px solid #6366f1;padding-left:1rem}
    .article-content h3{color:#4a5568;font-size:1.3rem;font-weight:600;margin:1.5rem 0 .8rem}
    .article-content h4{color:#4a5568;font-size:1.1rem;font-weight:600;margin:1.2rem 0 .6rem}
    .article-content p{margin-bottom:1.2rem;line-height:1.7;color:#4a5568}
    .article-content ul,.article-content ol{margin:1rem 0 1.5rem 2rem;color:#4a5568}
    .article-content li{margin-bottom:.5rem;line-height:1.6}
    .article-content blockquote{border-left:4px solid #fbbf24;background:#fffbeb;padding:1rem 1.5rem;margin:1.5rem 0;border-radius:0 6px 6px 0}
    .article-content blockquote p{margin:0;font-style:italic;color:#92400e}
    .article-content code{background:#f1f5f9;color:#e11d48;padding:.2rem .4rem;border-radius:3px;font-family:'Monaco','Consolas',monospace;font-size:.9em}
    .article-content pre{background:#1e293b;color:#e2e8f0;padding:1.5rem;border-radius:8px;overflow-x:auto;margin:1.5rem 0;font-family:'Monaco','Consolas',monospace;line-height:1.5}
    .article-content pre code{background:none;color:inherit;padding:0;border-radius:0}
    .article-content a{color:#6366f1;text-decoration:none;font-weight:500;border-bottom:1px solid transparent;transition:border-color .2s ease}
    .article-content a:hover{border-bottom-color:#6366f1}
    .article-content img{max-width:100%;height:auto;border-radius:8px;margin:1.5rem 0;box-shadow:0 10px 30px rgba(0,0,0,.12);cursor:zoom-in}
    /* Subtle inline highlight for search matches */
    .hl{
        background: rgba(99,102,241,.18);
        color: inherit;
        padding: 0 .25em;
        border-radius: 6px;
        -webkit-box-decoration-break: clone;
        box-decoration-break: clone;
    }
    @media (max-width:768px){.main-content{grid-template-columns:1fr}.sidebar{max-height:none;border-right:none;border-bottom:1px solid rgba(255,255,255,.2)}.header h1{font-size:2rem}.content{padding:1rem}.article-content h1{font-size:2rem}.article-content h2{font-size:1.5rem}}
    @media (max-width:480px){.logo{flex-direction:column;gap:.5rem}.alpaca-emoji{font-size:2rem!important}.header h1{font-size:1.8rem}.subtitle{font-size:1rem}}
    .sidebar::-webkit-scrollbar,.content::-webkit-scrollbar{width:6px}
    .sidebar::-webkit-scrollbar-track,.content::-webkit-scrollbar-track{background:transparent}
    .sidebar::-webkit-scrollbar-thumb,.content::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}
    .sidebar::-webkit-scrollbar-thumb:hover,.content::-webkit-scrollbar-thumb:hover{background:#94a3b8}
    .sidebar,.content{scrollbar-color:#cbd5e1 transparent}
    #back-to-top{position:fixed;right:18px;bottom:24px;width:42px;height:42px;border-radius:50%;border:none;background:linear-gradient(135deg,#6366f1,#22d3ee);color:#fff;box-shadow:0 10px 20px rgba(99,102,241,.35);cursor:pointer;display:flex;opacity:0;pointer-events:none;align-items:center;justify-content:center;font-size:18px;transform:translateY(8px);transition:opacity .2s ease,transform .2s ease}
    .lightbox{display:none}.lightbox.open{display:block}.lightbox .lightbox-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(2px)}.lightbox img{position:fixed;max-width:90vw;max-height:85vh;left:50%;top:50%;transform:translate(-50%,-50%);border-radius:12px;box-shadow:0 20px 50px rgba(0,0,0,.5)}.lightbox-close{position:fixed;right:24px;top:18px;background:rgba(255,255,255,.9);border:none;border-radius:8px;padding:6px 10px;cursor:pointer}
    .dark{--bg-grad-a:#0f172a;--bg-grad-b:#1f2937;--text:#e5e7eb;--muted:#cbd5e1;--brand:#8b5cf6;--brand-2:#22d3ee;--accent:#22d3ee;--border:#1f2937}
    .dark .container,.dark .sidebar,.dark .content{background:transparent}
    /* Dark theme opaque header */
    .dark .header{background:#0b1220;color:#e5e7eb;box-shadow:0 6px 20px rgba(0,0,0,.5)}
    .dark .header h1{background:linear-gradient(45deg,#e5e7eb,#cbd5e1);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .dark .subtitle{color:#cbd5e1}
    .dark .lang-btn{background:#111827;border-color:#1f2937;color:#e5e7eb}
    .dark .lang-btn:hover{background:#0b1220;border-color:#374151}
    .dark .lang-btn.active{background:linear-gradient(135deg,#8b5cf6,#22d3ee);color:#0b1220;border-color:transparent}
    .dark .theme-toggle{background:#111827;border-color:#1f2937;color:#e5e7eb}
    .dark .theme-toggle:hover{background:#0b1220;border-color:#374151}
    /* focus-visible accessibility */
    .lang-btn:focus-visible,.theme-toggle:focus-visible,#nav-search:focus-visible,.chapter-section a:focus-visible{outline:2px solid #a78bfa;outline-offset:2px}
    
    /* Code block enhancements */
    .article-content pre{position:relative}
    .copy-code-btn{position:absolute;top:8px;right:8px;background:rgba(255,255,255,.9);border:1px solid #e2e8f0;color:#4a5568;padding:4px 8px;border-radius:4px;font-size:12px;cursor:pointer;opacity:0;transition:opacity .2s ease}
    .article-content pre:hover .copy-code-btn{opacity:1}
    .copy-code-btn:hover{background:#f8fafc;border-color:#cbd5e1}
    .copy-code-btn.copied{background:#dcfce7;border-color:#86efac;color:#166534}
    
    /* Reduce motion for accessibility */
    @media (prefers-reduced-motion: reduce) {
        *,::before,::after{animation-duration:.01ms !important;animation-iteration-count:1 !important;transition-duration:.01ms !important}
        .reveal-in{transition:none !important}
        #back-to-top{transition:none !important}
    }
    .dark .chapter-section{background:rgba(17,24,39,.9)}
    .dark .chapter-section:hover{background:rgba(17,24,39,.95);box-shadow:0 8px 24px rgba(0,0,0,.5)}
    .dark .chapter-section a{color:#cbd5e1}
    .dark .chapter-section a:hover{background:rgba(255,255,255,.06);color:#fff}
    .dark .article-content{background:rgba(11,18,32,.9);border-color:#111827;box-shadow:0 10px 30px rgba(0,0,0,.5)}
    .dark .article-content h1{color:#fff;border-color:var(--brand)}
    .dark .article-content h2,.dark .article-content h3,.dark .article-content h4{color:#e5e7eb}
    .dark .article-content p,.dark .article-content li{color:#cbd5e1}
    .dark .article-content blockquote{background:#1f2937;border-left-color:#f59e0b}
    .dark .article-content code{background:#111827;color:#f87171}
    .dark .article-content pre{background:#0b0f1a}
    .dark .footer{background:linear-gradient(135deg,#0b1220,#1f2937,#0b1220)}
    .dark .footer a{color:#93c5fd}
    
    /* Dark theme header */
    .dark .header{background:#0b1220;color:#e5e7eb;box-shadow:0 6px 20px rgba(0,0,0,.5)}
    .dark .header h1{background:linear-gradient(45deg,#e5e7eb,#cbd5e1);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .dark .subtitle{color:#cbd5e1}
    .dark .lang-btn{background:#111827;border-color:#1f2937;color:#e5e7eb}
    .dark .lang-btn:hover{background:#0b1220;border-color:#374151}
    .dark .lang-btn.active{background:linear-gradient(135deg,#8b5cf6,#22d3ee);color:#0b1220;border-color:transparent}
    .dark .theme-toggle{background:#111827;border-color:#1f2937;color:#e5e7eb}
    .dark .theme-toggle:hover{background:#0b1220;border-color:#374151}
    .dark .copy-code-btn{background:rgba(17,24,39,.9);border-color:#374151;color:#cbd5e1}
    .dark .copy-code-btn:hover{background:#0f172a;border-color:#4b5563}
    .dark .copy-code-btn.copied{background:#064e3b;border-color:#059669;color:#a7f3d0}

.footer a:hover {
    color: white;
    text-decoration: underline;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

.loading p {
    font-size: 1.1rem;
    color: #6b7280;
    background: linear-gradient(135deg, #6b7280, #6366f1);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.error p {
    color: #dc2626;
    font-size: 1.1rem;
}

/* Article content styling */
.article-content {
    max-width: 1100px;
    margin: 0 auto;
}

/* In-article layout with TOC */
.article-layout { display: grid; grid-template-columns: 240px 1fr; gap: 28px; }
.article-toc { position: sticky; top: 80px; height: calc(100vh - 160px); overflow: auto; }
.toc { background: rgba(99,102,241,.06); border: 1px solid #eef2ff; border-radius: 12px; padding: 14px; }
.toc-title { font-size: .9rem; color: #4a5568; margin-bottom: .4rem; font-weight: 600; }
.toc ul { list-style: none; padding-left: 0; margin: 0; }
.toc li { margin: 6px 0; }
.toc a { color: #4b5563; text-decoration: none; font-size: .9rem; border-left: 2px solid transparent; padding-left: .4rem; display: block; }
.toc a:hover { color: #111827; border-left-color: #a5b4fc; }
.toc a.active { color: #111827; border-left-color: #6366f1; font-weight: 600; }
.toc .lvl-1 a { font-weight: 600; }
.toc .lvl-3 a { opacity: .85; font-size: .85rem; }
.article-content-inner { max-width: 800px; }

@media (max-width: 1100px) {
    .article-layout { grid-template-columns: 1fr; }
    .article-toc { display: none; }
}

.dark .toc { background: rgba(99,102,241,.08); border-color: #111827; }
.dark .toc-title { color: #cbd5e1; }
.dark .toc a { color: #cbd5e1; }
.dark .toc a:hover { color: #fff; border-left-color: #8b5cf6; }
.dark .toc a.active { color: #fff; border-left-color: #8b5cf6; }

.article-content h1 {
    color: #1a202c;
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    border-bottom: 3px solid #6366f1;
    padding-bottom: 0.5rem;
}

.article-content h2 {
    color: #2d3748;
    font-size: 1.8rem;
    font-weight: 600;
    margin: 2rem 0 1rem;
    border-left: 4px solid #6366f1;
    padding-left: 1rem;
}

.article-content h3 {
    color: #4a5568;
    font-size: 1.3rem;
    font-weight: 600;
    margin: 1.5rem 0 0.8rem;
}

.article-content h4 {
    color: #4a5568;
    font-size: 1.1rem;
    font-weight: 600;
    margin: 1.2rem 0 0.6rem;
}

.article-content p {
    margin-bottom: 1.2rem;
    line-height: 1.7;
    color: #4a5568;
}

.article-content ul, .article-content ol {
    margin: 1rem 0 1.5rem 2rem;
    color: #4a5568;
}

.article-content li {
    margin-bottom: 0.5rem;
    line-height: 1.6;
}

.article-content blockquote {
    border-left: 4px solid #fbbf24;
    background: #fffbeb;
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    border-radius: 0 6px 6px 0;
}

.article-content blockquote p {
    margin: 0;
    font-style: italic;
    color: #92400e;
}

.article-content code {
    background: #f1f5f9;
    color: #e11d48;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-family: 'Monaco', 'Consolas', monospace;
    font-size: 0.9em;
}

.article-content pre {
    background: #1e293b;
    color: #e2e8f0;
    padding: 1.5rem;
    border-radius: 8px;
    overflow-x: auto;
    margin: 1.5rem 0;
    font-family: 'Monaco', 'Consolas', monospace;
    line-height: 1.5;
}

.article-content pre code {
    background: none;
    color: inherit;
    padding: 0;
    border-radius: 0;
}

.article-content a {
    color: #6366f1;
    text-decoration: none;
    font-weight: 500;
    border-bottom: 1px solid transparent;
    transition: border-color 0.2s ease;
}

.article-content a:hover {
    border-bottom-color: #6366f1;
}

.article-content img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 1.5rem 0;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
    cursor: zoom-in;
}

/* Search highlight */
.hl {
    background: rgba(99,102,241,.18);
    color: inherit;
    padding: 0 .25em;
    border-radius: 6px;
    -webkit-box-decoration-break: clone;
    box-decoration-break: clone;
}

.article-content hr {
    border: none;
    height: 2px;
    background: linear-gradient(90deg, transparent, #e2e8f0, transparent);
    margin: 2rem 0;
}

.article-content strong {
    color: #1a202c;
    font-weight: 600;
}

.article-content em {
    color: #6b7280;
}

/* Responsive design */
@media (max-width: 768px) {
    .main-content {
        grid-template-columns: 1fr;
    }
    
    .sidebar {
        max-height: none;
        border-right: none;
        border-bottom: 1px solid #e2e8f0;
    }
    
    .header h1 {
        font-size: 2rem;
    }
    
    .content {
        padding: 1rem;
    }
    
    .article-content h1 {
        font-size: 2rem;
    }
    
    .article-content h2 {
        font-size: 1.5rem;
    }
}

@media (max-width: 480px) {
    .logo {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .alpaca-emoji {
        font-size: 2rem !important;
    }
    
    .header h1 {
        font-size: 1.8rem;
    }
    
    .subtitle {
        font-size: 1rem;
    }
}

/* Scrollbar styling */
.sidebar::-webkit-scrollbar,
.content::-webkit-scrollbar {
    width: 6px;
}

.sidebar::-webkit-scrollbar-track,
.content::-webkit-scrollbar-track {
    background: transparent;
}

.sidebar::-webkit-scrollbar-thumb,
.content::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
}

.sidebar::-webkit-scrollbar-thumb:hover,
.content::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}

/* Firefox scrollbar colors: thumb + transparent track */
.sidebar, .content { scrollbar-color: #cbd5e1 transparent; }

/* Back to top */
#back-to-top {
    position: fixed;
    right: 18px;
    bottom: 24px;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, #6366f1, #22d3ee);
    color: #fff;
    box-shadow: 0 10px 20px rgba(99,102,241,.35);
    cursor: pointer;
    display: flex;
    opacity: 0;
    pointer-events: none;
    align-items: center;
    justify-content: center;
    font-size: 18px;
}


/* Lightbox */
.lightbox { display: none; }
.lightbox.open { display: block; }
.lightbox .lightbox-backdrop {
    position: fixed; inset: 0; background: rgba(0,0,0,.6); backdrop-filter: blur(2px);
}
.lightbox img {
    position: fixed; max-width: 90vw; max-height: 85vh; left: 50%; top: 50%; transform: translate(-50%, -50%);
    border-radius: 12px; box-shadow: 0 20px 50px rgba(0,0,0,.5);
}
.lightbox-close {
    position: fixed; right: 24px; top: 18px; background: rgba(255,255,255,.9); border: none; border-radius: 8px; padding: 6px 10px; cursor: pointer;
}

/* Dark mode */
.dark {
    --bg-grad-a: #0f172a;
    --bg-grad-b: #1f2937;
    --text: #e5e7eb;
    --muted: #cbd5e1;
    --panel: #0b1220;
    --panel-2: #0f172a;
    --brand: #8b5cf6;
    --brand-2: #22d3ee;
    --accent: #22d3ee;
    --border: #1f2937;
}
.dark .container { background: rgba(10, 13, 23, .85); box-shadow: 0 0 60px rgba(0,0,0,.6); }
.dark .sidebar { background: linear-gradient(180deg, #0f172a 0%, #0b1220 100%); }
.dark .chapter-section { background: rgba(255,255,255,.04); }
.dark .chapter-section:hover { background: rgba(255,255,255,.08); box-shadow: 0 4px 20px rgba(0,0,0,.3); }
.dark .chapter-section a { color: #cbd5e1; }
.dark .chapter-section a:hover { background: rgba(255,255,255,.06); color: #fff; }
.dark .content { background: linear-gradient(180deg, #0b1220 0%, #0f172a 100%); }
.dark .article-content { background: #0b1220; border-color: #111827; box-shadow: 0 10px 30px rgba(0,0,0,.5); }
.dark .article-content h1 { color: #fff; border-color: var(--brand); }
.dark .article-content h2, .dark .article-content h3, .dark .article-content h4 { color: #e5e7eb; }
.dark .article-content p, .dark .article-content li { color: #cbd5e1; }
.dark .article-content blockquote { background: #1f2937; border-left-color: #f59e0b; }
.dark .article-content code { background: #111827; color: #f87171; }
.dark .article-content pre { background: #0b0f1a; }
.dark .footer { background: linear-gradient(135deg, #0b1220, #1f2937, #0b1220); }
.dark .footer a { color: #93c5fd; }